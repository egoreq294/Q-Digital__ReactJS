(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{39:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var o=n(6),i=n(0),a=n.n(i),r=n(19),c=n.n(r),s=(n(39),n(22)),h=n(8),u=n(23),d=n(11),p=n.n(d),l=n(15),m=n(1),f=n(4),w=n(2),g=n(3),b=n(5),v=n(29),j=n.n(v),x=[{id:0,path:n.p+"static/media/pano_1.4ac5959f.png",coords:{x:0,y:0,z:0},description:"\u0446\u0435\u043d\u0442\u0440 \u043f\u0435\u0440\u0435\u043a\u0440\u0435\u0441\u0442\u043a\u0430",siblings:[1,2,3]},{id:1,path:n.p+"static/media/pano_2.0ed9c6cd.png",coords:{x:1,y:0,z:0},description:"\u0443 \u043f\u0435\u043a\u0430\u0440\u043d\u0438",siblings:[0,5],direction:130},{id:2,path:n.p+"static/media/pano_3.f876bed8.png",coords:{x:1.5,y:0,z:1},description:"\u0432\u043e\u0437\u043b\u0435 \u0440\u0435\u043a\u043b\u0430\u043c\u044b",siblings:[0],direction:90},{id:3,path:n.p+"static/media/pano_4.f285cefe.png",coords:{x:-1,y:0,z:0},description:"\u043d\u0430\u043f\u0440\u043e\u0442\u0438\u0432 \u043f\u0435\u043a\u0430\u0440\u043d\u0438",siblings:[0,7]},{id:5,path:n.p+"static/media/pano_2_2.25aa25a5.png",coords:{x:1,y:0,z:-10},description:"\u0441\u043b\u0435\u0432\u0430 \u043e\u0442 \u043f\u0435\u043a\u0430\u0440\u043d\u0438",siblings:[1,6],direction:90},{id:6,path:n.p+"static/media/pano_2_2_1.e27ba1d9.png",coords:{x:1,y:0,z:-20},description:"\u0435\u0449\u0435 \u043b\u0435\u0432\u0435\u0435 \u043f\u0435\u043a\u0430\u0440\u043d\u0438",siblings:[5],direction:90},{id:7,path:n.p+"static/media/pano_4_1.b07816c8.png",coords:{x:-2,y:0,z:0},description:"\u0435\u0449\u0435 \u0434\u0430\u043b\u044c\u0448\u0435 \u043e\u0442 \u043f\u0435\u043a\u0430\u0440\u043d\u0438",siblings:[3]}];var O=function e(t){var n=this;Object(m.a)(this,e),this.init=function(e,t,o,i,a,r){var c,s,h;n.vectorFromTo=function(e,t,n,o,i,a){return{x:o-e,y:i-t,z:a-n}}(e,t,o,i,a,r),n.vectorLengh=(c=n.vectorFromTo.x,s=n.vectorFromTo.y,h=n.vectorFromTo.z,Math.sqrt(c*c+s*s+h*h)),n.unitVector=function(e,t,n,o){return{x:e/o,y:t/o,z:n/o}}(n.vectorFromTo.x,n.vectorFromTo.y,n.vectorFromTo.z,n.vectorLengh);var u=new b.c;!function(e,t,n,o,i,a){e.vertices.push(new b.o(i*o,i*n,i*-t)),e.vertices.push(new b.o(i*t,i*n,i*o)),e.vertices.push(new b.o(i*-o,i*n,i*t)),e.vertices.push(new b.o(i*o,i*(n+a),i*-t)),e.vertices.push(new b.o(i*t,i*(n+a),i*o)),e.vertices.push(new b.o(i*-o,i*(n+a),i*t)),e.faces.push(new b.b(0,1,2)),e.faces.push(new b.b(3,4,5)),e.faces.push(new b.b(0,2,5)),e.faces.push(new b.b(0,3,5)),e.faces.push(new b.b(0,4,1)),e.faces.push(new b.b(0,3,4)),e.faces.push(new b.b(2,4,1)),e.faces.push(new b.b(5,2,4)),e.computeFaceNormals()}(u,n.unitVector.x,n.unitVector.y,n.unitVector.z,.1,.3);var d=new b.g({color:65280,side:b.a});n.mesh=new b.e(u,d),n.mesh.idTo=n.idTo,n.mesh.unitVector=n.unitVector,n.mesh.position.y=-.3,n.mesh.position.x=.5*n.unitVector.x,n.mesh.position.z=.5*n.unitVector.z},this.idTo=t},y=function e(t,n){var o=this,i=t.id,a=t.path,r=t.coords,c=t.siblings,s=t.direction;Object(m.a)(this,e),this.arrows=[],this.loadTexture=function(){return new Promise((function(e){(new b.m).load(o.path,(function(t){o.texture=t,e(t)}))}))},this.createArrows=function(){o.siblings.forEach((function(e){var t=x.find((function(t){return t.id===e})),n=new O(e);n.init(o.coords.x,o.coords.y,o.coords.z,t.coords.x,t.coords.y,t.coords.z),o.arrows.push(n.mesh),o.app.scene.add(n.mesh)}))},this.removeArrows=function(){o.arrows.forEach((function(e){o.app.scene.remove(e)})),o.arrows=[]},this.id=i,this.path=a,this.coords=r,this.siblings=c,this.direction=s,this.app=n},S=function e(t){var n=this;Object(m.a)(this,e),this.init=Object(l.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.location=new y(x[0],n.app),n.geometry=new b.l(1,32,32),n.material=new b.f({side:b.a,transparent:!0}),n.mesh=new b.e(n.geometry,n.material),n.mesh.scale.set(-1,1,-1);case 5:case"end":return e.stop()}}),e)}))),this.changeTo=function(){var e=Object(l.a)(p.a.mark((function e(t,o){var i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.location.removeArrows(),n.mesh.rotation.y=0,n.location=n.app.locations.find((function(e){return e.id===t})),!n.location){e.next=7;break}n.mesh.material.map=n.location.texture,e.next=15;break;case 7:return n.app.setState({isLoading:!0}),n.app.toggleControl=!1,i=x.find((function(e){return e.id===t})),n.location=new y(i,n.app),n.app.locations.push(n.location),e.next=14,n.location.loadTexture().then((function(){n.app.setState({isLoading:!1}),n.app.toggleControl=!0}));case 14:n.mesh.material.map=n.location.texture;case 15:o&&n.location.createArrows(),n.location.direction&&n.rotateSphere(n.location.direction),n.location.siblings.forEach(function(){var e=Object(l.a)(p.a.mark((function e(t){var o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.app.locations.find((function(e){return e.id===t}))){e.next=7;break}return o=x.find((function(e){return e.id===t})),i=new y(o,n.app),e.next=6,i.loadTexture();case 6:n.app.locations.push(i);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.rotateSphere=function(e){n.mesh.rotation.y=e*Math.PI/180},this.app=t},k=function(e){Object(w.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(m.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).locations=[],e.lat=0,e.lon=0,e.phi=0,e.theta=0,e.state={isLoading:!0,currentId:0},e.toggleControl=!0,e.mouse=new b.n,e.raycaster=new b.j,e.mount=a.a.createRef(),e.onMapClick=function(e){var t=e.target.closest("span");e.target!==t&&document.querySelector(".map").classList.toggle("active")},e.onDotClick=function(t,n){var o=t.target.closest("span");t.target===o&&(document.querySelector(".map").classList.contains("active")&&(e.mainSphere.changeTo(n,!0),e.setState({currentId:n})),document.querySelector(".map").classList.toggle("active"))},e.onWindowResize=function(){e.camera.aspect=window.innerWidth/window.innerHeight,e.camera.updateProjectionMatrix(),e.renderer.setSize(window.innerWidth,window.innerHeight)},e.onPointerStart=function(t){if(e.toggleControl){var n=t.clientX||t.touches[0].clientX,o=t.clientY||t.touches[0].clientY;e.mouseDownMouseX=n,e.mouseDownMouseY=o,e.mouseDownLon=e.lon,e.mouseDownLat=e.lat}},e.onPointerMove=function(t){if(e.toggleControl){if(!e.mouseDownMouseX)return;var n=t.clientX||t.touches[0].clientX,o=t.clientY||t.touches[0].clientY;e.lon=(e.mouseDownMouseX-n)*e.camera.fov/600+e.mouseDownLon,e.lat=(o-e.mouseDownMouseY)*e.camera.fov/600+e.mouseDownLat}},e.onPointerUp=function(){e.toggleControl&&(e.mouseDownMouseX=null)},e.onArrowClick=function(){var t=Object(l.a)(p.a.mark((function t(n){var o,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.toggleControl){t.next=16;break}if(e.mouse.x=n.clientX/window.innerWidth*2-1,e.mouse.y=-n.clientY/window.innerHeight*2+1,e.raycaster.setFromCamera(e.mouse,e.camera),!(o=e.raycaster.intersectObjects(e.mainSphere.location.arrows,!0)).length){t.next=16;break}return e.toggleControl=!1,e.phi=Math.acos(o[0].object.unitVector.y),e.theta=Math.atan2(o[0].object.unitVector.z,o[0].object.unitVector.x),e.lon=b.d.radToDeg(e.theta),e.lat=90-b.d.radToDeg(e.phi),t.next=13,e.secondSphere.changeTo(o[0].object.idTo,!1);case 13:i=Object.assign(o[0].object.unitVector,{opc1:1,opc2:0}),e.mainSphere.location.removeArrows(),new j.a.Tween(i).to({x:0,y:0,z:0,opc1:0,opc2:1},1e3).onUpdate((function(){e.secondSphere.mesh.position.set(.8*i.x,.8*i.y,.8*i.z),e.mainSphere.mesh.material.opacity=i.opc1,e.secondSphere.mesh.material.opacity=i.opc2})).start().onComplete(Object(l.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.mainSphere.mesh.material.opacity=1,e.secondSphere.mesh.material.opacity=0,e.secondSphere.mesh.position.set(10,10,10),t.next=5,e.mainSphere.changeTo(o[0].object.idTo,!0);case 5:e.toggleControl=!0,e.setState({currentId:o[0].object.idTo});case 7:case"end":return t.stop()}}),t)}))));case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.animate=function(){requestAnimationFrame(e.animate),e.lat=Math.max(-85,Math.min(85,e.lat)),e.phi=b.d.degToRad(90-e.lat),e.theta=b.d.degToRad(e.lon),e.camera.target.x=Math.sin(e.phi)*Math.cos(e.theta),e.camera.target.y=Math.cos(e.phi),e.camera.target.z=Math.sin(e.phi)*Math.sin(e.theta),e.camera.lookAt(e.camera.target),e.renderer.render(e.scene,e.camera),j.a.update()},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=Object(l.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene=new b.k,this.camera=new b.h(90,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new b.p,this.renderer.setSize(window.innerWidth,window.innerHeight),this.mount.current.appendChild(this.renderer.domElement),this.light=new b.i(16777215),this.light.position.y=10,this.scene.add(this.light),this.mainSphere=new S(this),this.mainSphere.init(),this.scene.add(this.mainSphere.mesh),e.next=13,this.mainSphere.changeTo(0,!0);case 13:return this.secondSphere=new S(this),this.secondSphere.init(),this.secondSphere.mesh.position.z=-2,this.scene.add(this.secondSphere.mesh),e.next=19,this.secondSphere.changeTo(0,!1);case 19:this.camera.target=new b.o(0,0,0),this.mount.current.addEventListener("click",this.onArrowClick),window.addEventListener("mousedown",this.onPointerStart),window.addEventListener("mousemove",this.onPointerMove),window.addEventListener("mouseup",this.onPointerUp),window.addEventListener("resize",this.onWindowResize),this.animate();case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(o.jsxs)(a.a.Fragment,{children:[this.state.isLoading&&Object(o.jsx)("div",{className:"loader-block",children:Object(o.jsx)("div",{id:"cube-loader",children:Object(o.jsx)("div",{className:"caption",children:Object(o.jsxs)("div",{className:"cube-loader",children:[Object(o.jsx)("div",{className:"cube loader-1"}),Object(o.jsx)("div",{className:"cube loader-2"}),Object(o.jsx)("div",{className:"cube loader-4"}),Object(o.jsx)("div",{className:"cube loader-3"})]})})})}),!this.state.isLoading&&Object(o.jsx)("div",{onClick:function(t){e.onMapClick(t)},className:"map",children:Object(o.jsx)("div",{className:"map__container",children:x.map((function(t,n){return Object(o.jsx)("span",{className:"map__container__dot ".concat(t.id===e.state.currentId&&"active"),style:{left:"".concat(20*t.coords.x+50,"%"),top:"".concat(2*t.coords.z+50,"%")},onClick:function(n){e.onDotClick(n,t.id)}},n)}))})}),Object(o.jsx)("div",{ref:this.mount})]})}}]),n}(a.a.Component),T=n(24);var z=function(e){return Object(o.jsx)("div",{onClick:e.onClick,className:"".concat(e.className," button"),children:e.text})};var C=function(e){var t=Object(i.useState)([0]),n=Object(T.a)(t,2),a=n[0],r=n[1];return Object(o.jsxs)("div",{className:"slider",children:[Object(o.jsx)(z,{onClick:function(){var t=e.imgs,n=a;--n<0&&(n=t.length-1),r(n)},text:"prev"}),e.imgs[0]&&Object(o.jsx)("img",{className:"slider__img",src:e.imgs[a].source,alt:""}),Object(o.jsx)(z,{onClick:function(){var t=e.imgs,n=a;++n>t.length-1&&(n=0),r(n)},text:"next"})]})},M="REMOTE",_=[{id:1,source:n.p+"static/media/img0.556b7df4.jpg"},{id:2,source:n.p+"static/media/img1.7cf16e7e.jpg"},{id:3,source:n.p+"static/media/img2.439e5ef5.jpg"}];var L=Object(u.b)((function(e){return{remoteStore:e.remote}}),{setRemote:function(e){return{type:M,remote:e}}})((function(e){var t=Object(i.useState)("local"),n=Object(T.a)(t,2),a=n[0],r=n[1];Object(i.useEffect)((function(){fetch("https://imagesapi.osora.ru/").then((function(e){return e.json()})).then((function(e){return e.map((function(e,t){return{id:t,source:e}}))})).then((function(t){e.setRemote(t)})).catch((function(e){alert(e)}))}),[]);var c="local"===a?_:e.remoteStore;return Object(o.jsxs)("section",{className:"slider-page",children:[e.remoteStore&&Object(o.jsx)(C,{className:"slider",imgs:c}),Object(o.jsx)(z,{className:"slider__btn",onClick:function(){r("local"===a?"remote":"local")},text:"switch to remote"}),Object(o.jsx)(s.b,{className:"link slider__link",to:"/",children:"Back to main"})]})})),N=n(21),D={remote:[]};var E=Object(N.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return{remote:t.remote};default:return e}}));var V=function(){return Object(o.jsx)(u.a,{store:E,children:Object(o.jsxs)(s.a,{children:[Object(o.jsx)(h.a,{exact:!0,path:"/",component:k}),Object(o.jsx)(h.a,{path:"/slider",component:L})]})})};c.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(V,{})}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.75233879.chunk.js.map